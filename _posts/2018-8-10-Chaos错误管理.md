# Chaos错误管理
## 错误类型
### 错误操作
* 参数设置缺失
* 参数设置错误

### 意外重启
* 在ifb初始化过程中意外退出（全局，执行一次）
* 在网卡转发规则设置过程中意外退出（单Pod，执行一次）
* 在netem设置过程中意外退出（全局，执行多次）

## 解决方案
### 错误操作
* 参数设置缺失

设置前检查参数，为空时按清空设置处理

* 参数设置错误

TC返回错误时，清空设置，产生错误日志，在done标志上标记"error"

### 意外重启
首先整理重启后仍然存在的设置：

1. ifb本身
2. 各个Pod网卡的转发规则
3. ifb上各个Pod的设置


* 在ifb初始化过程中意外退出（全局，执行一次）

启动时检测ifb是否已经工作，如果是，则不再初始化ifb

* 在网卡转发规则设置过程中意外退出（单Pod，执行一次）

在每次netem设置前检查转发规则，若规则有误，则重置转发规则

* 在netem设置过程中意外退出（全局，执行多次）

不需要额外处理，因为更新标志未被覆盖，因此下次重启会再次设置